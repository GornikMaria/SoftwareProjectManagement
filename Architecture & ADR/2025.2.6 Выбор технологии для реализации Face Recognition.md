- **Статус:** Принято
    
- **Дата:**  2025-02-05
    

**1. Контекст и постановка проблемы:**

Необходимо выбрать технологию (библиотеку, API, фреймворк) для реализации функции распознавания лиц в системе "TL Food". Эта функция используется в Kitchen Application для идентификации сотрудников при получении заказа. Ключевые требования:

- **Точность (FR-KITCHEN-1):** Высокая точность распознавания (минимизация ложноположительных и ложноотрицательных срабатываний). Целевые значения: True Positives >= 95%, False Positives <= 0.5%, False Negatives <= 5%.
    
- **Производительность (PER01):** Быстрое распознавание (время отклика не более 3 секунд).
    
- **Масштабируемость (SCA01):** Возможность обработки увеличивающегося количества запросов (в будущем).
    
- **Безопасность (SEC05):** Защита персональных данных (фотографий) пользователей.
    
- **Простота интеграции:** Относительная простота интеграции с существующей системой (C#, TypeScript).
    
- **Стоимость:** Учет стоимости использования (для облачных сервисов) или затрат на разработку и поддержку (для open-source решений).
    
- **Надежность (REL01):** Обеспечение постоянной доступности и корректной работы сервиса распознавания лиц.
    

**2. Альтернативы (с кратким описанием преимуществ и недостатков):**

1. **Облачный сервис распознавания лиц (Cloud Face Recognition API):**
    
    - Примеры: Azure Face API, Amazon Rekognition, Google Cloud Vision API, Face++.
        
    - Преимущества: Простота интеграции (обычно предоставляются SDK), высокая точность, масштабируемость, не нужно обучать собственную модель, регулярные обновления.
        
    - Недостатки: Зависимость от стороннего сервиса, оплата (может быть существенной при большом объеме запросов), вопросы приватности (передача фотографий на сторонний сервер), возможные задержки, связанные с сетевым взаимодействием.
        
2. **Open-source библиотека с предобученной моделью:**
    
    - Примеры: Dlib, OpenCV (с модулем face), face_recognition (Python-библиотека, использующая Dlib).
        
    - Преимущества: Бесплатность, полный контроль над кодом и данными, приватность, низкие задержки, возможность дообучения.
        
    - Недостатки: Сложность интеграции, точность может быть ниже, чем у облачных сервисов, необходимость самостоятельной настройки инфраструктуры для масштабируемости, самостоятельное отслеживание обновлений.
        
3. **Разработка собственного решения с нуля:**
    
    - Преимущества: Полный контроль над всеми аспектами системы, возможность создания решения, максимально адаптированного к специфическим требованиям проекта.
        
    - Недостатки: Чрезвычайно трудоемко, дорого, длительный срок разработки, не гарантируется высокое качество.
        

**3. Решение:**

Использовать **готовый облачный сервис распознавания лиц (Вариант 1)**. В качестве основного кандидата рассмотреть **Azure Face API**, учитывая имеющуюся экспертизу в .NET.

Разработка собственного решения с нуля (Вариант 3) отклоняется, так как это нецелесообразно для данного проекта (MVP, студенческий проект, ограниченные сроки и ресурсы).

**4. Обоснование решения:**

- **Точность (FR-KITCHEN-1):** Облачные сервисы, как правило, обеспечивают более высокую точность распознавания "из коробки", что критично для правильной идентификации сотрудников.
    
- **Производительность (PER01):** Облачные сервисы обеспечивают приемлемую производительность, даже с учетом сетевых задержек, и предоставляют гарантии масштабируемости.
    
- **Простота интеграции:** Облачные сервисы предоставляют SDK для C#, что упрощает интеграцию с существующим бэкендом.
    
- **Опыт команды:** Наличие опыта работы с .NET упрощает интеграцию с Azure Face API (если будет выбран именно этот сервис).
    
- **Высокая доступность** (AVA01)
    
- **Минимальные расходы ресурсов команды разработчиков** (мало времени)
    

**5. Последствия:**

- Удовлетворение функциональным требованиям: Функция распознавания лиц будет реализована в соответствии с FR-KITCHEN-1.
    
- Производительность: Система обеспечит приемлемое время распознавания лица (PER01).
    
- Масштабируемость: Система сможет обрабатывать увеличивающееся количество запросов (SCA01).
    
- Безопасность: Фотографии сотрудников будут передаваться на сторонний сервис, что требует особого внимания к вопросам безопасности и приватности.
    

**6. Риски:**

- **(Зависимость от стороннего сервиса):** Работа Face Recognition зависит от доступности и производительности Azure Face API (или другого выбранного облачного сервиса).
    
    - Смягчение: Разработка механизма fallback (например, ручной ввод табельного номера), мониторинг доступности сервиса, выбор надежного провайдера.
        
- **(Нарушение приватности):** Передача фотографий пользователей на сторонний сервер может вызвать вопросы с приватностью.
    
    - Смягчение: Заключение соглашения об обработке персональных данных с провайдером сервиса, анонимизация данных (если это возможно), получение согласия пользователей на обработку их фотографий, хранение ключа доступа к API в безопасном месте.
        
- **(Превышение бюджета):** Использование облачного сервиса может привести к значительным затратам, если количество запросов превысит ожидаемое.
    
    - Смягчение: Тщательное планирование бюджета, мониторинг использования сервиса, установка лимитов на количество запросов, оптимизация алгоритма распознавания (чтобы уменьшить количество запросов).
        
- **(Изменение цен на облачный сервис):** Поставщик облачного сервиса может поднять цены на услуги.
    
    - Смягчение: Анализ альтернативных решений, создание абстракции (слоя) над конкретным сервисом распознавания лиц для упрощения миграции на другой сервис.
    