- **Статус:** Принято
- **Дата:** 5 февраля 2025

**1. Контекст и постановка проблемы:**

Необходимо определить, как и где будет развернуто приложение "TL Food". Это включает в себя:

- **Веб-приложение (frontend):** Пользовательский интерфейс и интерфейс для кухни.
    
- **API Application (backend):** Серверная часть приложения.
    
- **Telegram Bot:**
    
- **Face Recognition Service:** Микросервис для распознавания лиц.
    
- **Database:** База данных (MSSQL).
    

Требования к развертыванию:

- **Надежность:** Система должна быть доступна для пользователей 24/7 (с минимальным временем простоя).
    
- **Масштабируемость:** Должна быть возможность увеличения производительности при росте нагрузки.
    
- **Безопасность:** Система должна быть защищена от несанкционированного доступа.
    
- **Простота развертывания и обновления:** Процесс развертывания и обновления приложения должен быть максимально простым и автоматизированным.
    
- **Стоимость:** Учет стоимости хостинга и других расходов, связанных с развертыванием.
    
- **Соответствие требованиям заказчика:** Развертывание должно соответствовать требованиям и возможностям компании-заказчика (ООО "Трэвэлайн"). В уставе проекта указано: "Хостинг: собственный сервер компании Travelline".
    

**2. Рассматриваемые варианты:**

- **Вариант 1: Развертывание на собственном сервере компании "Трэвэлайн".**
    
    - Описание: Использование существующей инфраструктуры заказчика для развертывания приложения.
        
    - Преимущества:
        
        - **Соответствие требованиям:** Полностью соответствует требованию устава проекта.
            
        - **Потенциальная экономия:** Не нужно платить за сторонний хостинг.
            
        - **Полный контроль:** Заказчик имеет полный контроль над сервером и данными.
            
    - Недостатки:
        
        - **Требования к серверу:** Необходимо убедиться, что сервер заказчика соответствует требованиям приложения (операционная система, объем памяти, процессор, дисковое пространство).
            
        - **Настройка сервера:** Может потребоваться дополнительная настройка сервера (установка IIS, .NET, Node.js, Docker и т.д.).
            
        - **Обслуживание сервера:** Заказчик несет ответственность за обслуживание сервера (обновление ПО, мониторинг, резервное копирование).
            
- **Вариант 2: Облачный хостинг (Cloud Hosting).**
    
    - Описание: Использование облачных платформ (например, Microsoft Azure, Amazon Web Services, Google Cloud Platform) для развертывания приложения.
        
    - Преимущества:
        
        - **Масштабируемость:** Облачные платформы позволяют легко масштабировать приложение.
            
        - **Надежность:** Облачные платформы обеспечивают высокую доступность и отказоустойчивость.
            
        - **Простота развертывания:** Многие облачные платформы предоставляют инструменты для упрощенного развертывания приложений (например, Azure App Service, AWS Elastic Beanstalk).
            
        - **Широкий выбор сервисов:** Облачные платформы предлагают множество дополнительных сервисов (базы данных, хранилища, очереди сообщений, сервисы машинного обучения и т.д.).
            
    - Недостатки:
        
        - **Стоимость:** Использование облачных платформ может быть дорогим, особенно при большом объеме трафика и данных.
            
        - **Зависимость от стороннего провайдера:** Работа системы зависит от доступности и производительности облачной платформы.
            
        - **Не соответсвует уставу**
            
- **Вариант 3: Гибридный**
    

**3. Решение:**

Развертывание на **собственном сервере компании "Трэвэлайн" (Вариант 1)**.

**4. Обоснование решения:**

- **Соответствие уставу проекта:** Это основной аргумент. В уставе проекта четко указано, что хостинг должен осуществляться на собственном сервере компании.
    
- **Контроль и безопасность**
    

**5. Детали реализации:**

- **Операционная система:** Уточнить у заказчика, какая операционная система установлена на сервере. Предпочтительно – Windows Server (для лучшей совместимости с .NET и MSSQL).
    
- **Веб-сервер:** IIS (Internet Information Services) для ASP.NET Core API и React приложений.
    
- **База данных:** Microsoft SQL Server (уже выбрана в другом ADR).
    
- **Контейнеризация (Docker):** Рекомендуется использовать Docker для контейнеризации приложений (веб-приложение, API, Telegram-бот, Face Recognition Service). Это упростит развертывание, обновление и масштабирование.
    
    - Создать Dockerfile для каждого приложения.
        
    - Использовать Docker Compose для управления несколькими контейнерами.
        
- **CI/CD (Continuous Integration/Continuous Delivery):** Настроить CI/CD-пайплайн для автоматизации сборки, тестирования и развертывания приложения. Можно использовать:
    
    - Azure DevOps (если у заказчика есть подписка).
        
    - Jenkins.
        
    - GitLab CI/CD.
        
    - GitHub Actions.
        
- **Мониторинг:** Настроить мониторинг состояния сервера и приложений (загрузка CPU, память, дисковое пространство, доступность, ошибки). Можно использовать:
    
    - Встроенные средства Windows Server.
        
    - Zabbix.
        
    - Nagios.
        
    - Prometheus + Grafana.
        
- **Резервное копирование:** Настроить регулярное резервное копирование базы данных и важных файлов.
    
- **Безопасность:**
    
    - Настроить firewall.
        
    - Использовать HTTPS для всех веб-приложений.
        
    - Регулярно обновлять ПО.
        

**6. Последствия:**

- **Положительные:**
    
    - Соответствие требованиям заказчика.
        
    - Полный контроль над инфраструктурой.
        
    - Потенциальная экономия на хостинге.
        
- **Отрицательные:**
    
    - Необходимость настройки и обслуживания сервера.
        
    - Ограниченная масштабируемость (по сравнению с облачным хостингом).
        

**7. Метрики:**

- **Время безотказной работы (uptime) системы.**
    
- **Время развертывания новой версии приложения.**
    
- **Время восстановления системы после сбоя.**
    
- **Загрузка сервера (CPU, память, диск).**