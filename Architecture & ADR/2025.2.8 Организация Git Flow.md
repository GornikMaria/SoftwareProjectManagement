- **Статус:** Принято
    
- **Дата:** 2025-02-10

**1. Контекст и постановка проблемы:**

Необходимо определить стратегию ветвления (Git flow) для проекта "TL Food". Нужен подход, который:

- Обеспечивает удобную совместную работу команды разработчиков (студентов).
    
- Позволяет вести разработку нескольких функций параллельно.
    
- Обеспечивает стабильность production-версии системы.
    
- Минимизирует риски потери кода и конфликтов при слиянии.
    
- Подходит для итеративной разработки (с частыми релизами MVP).
    
- Достаточно прост в использовании для начинающих разработчиков.
    
- Соответствует требованиям удобства для разработчиков (USA)
    
- Требует небольших усилий в поддержании и освоении (MAI)
    

**2. Рассматриваемые варианты (с кратким описанием преимуществ и недостатков):**

1. **GitHub Flow:**
    
    - Преимущества: Простота, подходит для небольших проектов с непрерывной поставкой (continuous delivery).
        
    - Недостатки: Не подходит для проектов с четким циклом релизов, сложнее поддерживать стабильность production-версии при активной разработке.
        
2. **Gitflow:**
    
    - Преимущества: Подходит для проектов с четким циклом релизов, обеспечивает строгий контроль над версиями, позволяет легко поддерживать старые версии.
        
    - Недостатки: Сложнее в использовании, чем GitHub Flow, требует больше усилий по управлению ветками, может быть избыточным для небольших проектов.
        
3. **Trunk-Based Development:**
    
    - Преимущества: Упрощает процесс интеграции, ускоряет разработку, позволяет быстро получать обратную связь.
        
    - Недостатки: Требует очень опытной команды и высокого уровня автоматизации тестирования, подходит только для проектов с непрерывной поставкой.
        
4. **Упрощенный Gitflow (с двумя основными ветками):**
    
    - Преимущества: Относительная простота, позволяет разрабатывать функции параллельно, обеспечивает стабильность production-версии, подходит для итеративной разработки.
        
    - Недостатки: Требует дисциплины при слиянии веток, может быть немного сложнее, чем GitHub Flow.
        

**3. Решение:**

Выбираем **упрощенный Gitflow (с двумя основными ветками)**.

**4. Обоснование решения:**

Упрощенный Gitflow обеспечивает баланс между простотой использования и возможностью параллельной разработки, что хорошо подходит для команды студентов, работающих над проектом "TL Food":

- **Простота освоения (MAI):** Меньше веток и правил по сравнению с полным Gitflow.
    
- **Две основные ветки:**
    
    - **main (production):** Содержит стабильный код, готовый к развертыванию в production (на сервере заказчика). Прямые коммиты в main запрещены.
        
    - **develop:** Основная ветка для разработки. Сюда сливаются все feature-ветки после проверки.
        
- **Feature-ветки:**
    
    - Для каждой новой задачи (feature, bugfix) создается отдельная ветка от develop.
        
    - Именование веток: feature/[краткое-описание-задачи] (например, feature/add-filters, feature/telegram-bot-reg), bugfix/[краткое-описание-бага] (например, bugfix/face-recognition-timeout).
        
- **Pull Requests (PR):**
    
    - Обязательное использование Pull Requests для слияния feature-веток в develop.
        
    - **Обязательный Code Review** (проверка кода другими членами команды) перед слиянием PR.
        
    - В описании PR обязательно указывать номер задачи (из таск-трекера) и краткое описание изменений.
        
- **Релизы:**
    
    - Релизы (развертывание на production-сервере) выполняются только из ветки main.
        
    - Перед релизом ветка develop сливается в main (через pull request).
        
    - После релиза создается тег (tag) в Git с номером версии (например, v1.0.0, v1.1.0).
        
- **Общее удобство для команды (USA):** Описываемый подход - компромисс между простотой и гибкостью
    

**5. Последствия:**

- Разработка: У команды появляется четкий процесс для совместной разработки новых функций и исправления ошибок.
    
- Стабильность: production-версия системы будет оставаться стабильной, так как все изменения проходят тщательную проверку перед слиянием в main.
    
- Управление версиями: Легко отслеживать изменения и откатываться к предыдущим версиям (благодаря тегам).
    
- Осваиваемость (MAI): Подход относительно прост в освоении и поддержке
    

**6. Риски:**

- **(Конфликты при слиянии):** Частое слияние feature-веток в develop может привести к конфликтам.
    
    - Смягчение: Регулярное слияние develop в feature-ветки, небольшие feature-ветки, Code Review.    
- **(Сложность релизного цикла для тех, кто первый раз):** Поначалу может возникнуть недопонимание, как сливать и где ветку  
    * Смягчение: Пошаговая инструкция